┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                  SilverLevelTransformer                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                      ▲                                                                                 
                                      │                                                                                 
                                      ▼                                                                                 
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                       __init__()                                                      │
│  • Sets up logging configuration                                                                                     │
│  • Initializes Spark session                                                                                        │
│  • Initializes database connector                                                                                   │
│  • Loads predefined schemas                                                                                         │
│  • Registers UDFs for data cleaning                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                      ▲                                                                                 
                                      │                                                                                 
                                      ▼                                                                                 
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                 transform_bronze_to_silver()                                          │
│  • Reads bronze data (cotations and indices) from Parquet files                                                     │
│  • Calls _transform_dataframe() for each dataset                                                                    │
│  • Saves transformed data to silver layer Parquet files                                                             │
│  • Saves transformed data to PostgreSQL                                                                            │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                      ▲                                                                                 
                                      │                                                                                 
                                      ▼                                                                                 
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                  _transform_dataframe()                                              │
│  • Filters out rows where 'valeur' contains numbers (cotations only)                                                │
│  • Cleans and standardizes 'valeur' field                                                                           │
│  • Adds temporal features (year, month, day of week, quarter)                                                      │
│  • Calculates daily variations                                                                                      │
│  • Validates against predefined schema                                                                              │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                                      ▲                                                                                 
                                      │                                                                                 
                                      ▼                                                                                 
┌─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│                                                      _save_to_postgres()                                             │
│  • Saves transformed DataFrames to PostgreSQL tables                                                               │
│  • Uses JDBC connection                                                                                            │
└─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘